<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Docker,">










<meta name="description" content="Securely build and share any application, anywhere.">
<meta name="keywords" content="Docker">
<meta property="og:type" content="article">
<meta property="og:title" content="docker基础学习笔记">
<meta property="og:url" content="http://blog.intersico.com/2020/02/29/OM/docker基础学习笔记/index.html">
<meta property="og:site_name" content="Every Day">
<meta property="og:description" content="Securely build and share any application, anywhere.">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://blog.intersico.com/2020/02/29/OM/docker基础学习笔记/head.jpg">
<meta property="og:updated_time" content="2020-09-03T09:40:39.829Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="docker基础学习笔记">
<meta name="twitter:description" content="Securely build and share any application, anywhere.">
<meta name="twitter:image" content="http://blog.intersico.com/2020/02/29/OM/docker基础学习笔记/head.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.intersico.com/2020/02/29/OM/docker基础学习笔记/">





  <title>docker基础学习笔记 | Every Day</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Every Day</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://blog.intersico.com/2020/02/29/OM/docker基础学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="R.D">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Every Day">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">docker基础学习笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-02-29T15:43:12+08:00">
                2020-02-29
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/运维/" itemprop="url" rel="index">
                    <span itemprop="name">运维</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <img src="/2020/02/29/OM/docker基础学习笔记/head.jpg">

<p>Securely build and share any application, anywhere.</p>
<a id="more"></a>

<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sudo yum install yum-utils device-mapper-persistent-data lvm2</span><br><span class="line">$</span><br><span class="line">$ sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">$ sudo yum install docker-ce</span><br><span class="line">$</span><br><span class="line">$ sudo systemctl enable docker</span><br><span class="line">$ sudo systemctl start docker</span><br></pre></td></tr></table></figure>

<p>启动与查看版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start docker</span><br><span class="line">sudo docker version</span><br></pre></td></tr></table></figure>

<h3 id="配置镜像"><a href="#配置镜像" class="headerlink" title="配置镜像"></a>配置镜像</h3><p>修改 <code>/etc/docker/daemon.json</code> 配置文件(不存在则创建)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;registry-mirrors&quot;: [</span><br><span class="line">        &quot;https://registry.docker-cn.com&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>重启docker</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure>

<p>验证配置是否生效</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker info</span><br><span class="line">## ......</span><br><span class="line">Registry Mirrors:</span><br><span class="line"> https://registry.docker-cn.com/</span><br><span class="line">## ......</span><br></pre></td></tr></table></figure>

<h3 id="镜像仓库"><a href="#镜像仓库" class="headerlink" title="镜像仓库"></a>镜像仓库</h3><p><a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#拉取镜像</span><br><span class="line">$ sudo docker pull nginx</span><br></pre></td></tr></table></figure>

<h3 id="管理命令"><a href="#管理命令" class="headerlink" title="管理命令"></a>管理命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#查看当前所有镜像</span><br><span class="line">$ docker images</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#删除本地镜像,参数是镜像的名称或 ID</span><br><span class="line">$ sudo docker rmi redis:3.2 redis:4.0 ...</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#启动镜像</span><br><span class="line">$ sudo docker run --name nginx -d nginx:1.12 //--name 起别名 -d在后台运行</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#查看已运行容器</span><br><span class="line">$ sudo docker ps</span><br><span class="line">#查看所有状态容器</span><br><span class="line">$ sudo docker ps -a</span><br><span class="line">#查看容器更详细信息</span><br><span class="line">$ sudo docker inspect nginx</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#停止、启动、删除容器</span><br><span class="line">$ sudo docker stop nginx</span><br><span class="line">$ sudo docker start nginx</span><br><span class="line">$ sudo docker rm nginx</span><br></pre></td></tr></table></figure>

<h3 id="exec-：连接容器内bash"><a href="#exec-：连接容器内bash" class="headerlink" title="exec ：连接容器内bash"></a>exec ：连接容器内bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># -i (--interactive)表示保持我们的输入流，只有使用它才能保证控制台程序能够正确识别我们的命令。</span><br><span class="line"># -t (--tty)表示启用一个伪终端，形成我们与 bash 的交互，如果没有它，我们无法看到 bash 内部的执行结果。</span><br><span class="line">$ sudo docker exec -it nginx bash</span><br></pre></td></tr></table></figure>

<h3 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h3><p>五种容器网络驱动：Bridge Driver、Host Driver、Overlay Driver、MacLan Driver、None Driver。</p>
<blockquote>
<p>Bridge(网桥) 网络是 Docker 容器的<strong>默认网络驱动</strong></p>
</blockquote>
<blockquote>
<p>Overlay 网络是借助 Docker 集群模块 Docker Swarm 来搭建的跨 Docker Daemon 网络，可以通过它搭建跨物理主机的虚拟网络，进而让不同物理机中运行的容器感知不到多个物理机的存在。</p>
</blockquote>
<ul>
<li>容器互连(–link)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># web容器连接数据库</span><br><span class="line">$ sudo docker run -d --name mysql -e MYSQL_RANDOM_ROOT_PASSWORD=yes mysql //启动mysql</span><br><span class="line">$ sudo docker run -d --name webapp --link mysql webapp:latest //启动web应用，并连接mysql容器内网络</span><br><span class="line"></span><br><span class="line">#JDBC链接为</span><br><span class="line">String url = &quot;jdbc:mysql://mysql:3306/webapp&quot;; //docker会自动指向Mysql容器的IP</span><br><span class="line"></span><br><span class="line"># 连接别名(--link &lt;name&gt;:&lt;alias&gt;)</span><br><span class="line">$ sudo docker run -d --name webapp --link mysql:alias-mysql webapp:latest</span><br><span class="line"></span><br><span class="line">#JDBC链接为</span><br><span class="line">String url = &quot;jdbc:mysql://alias-mysql:3306/webapp&quot;;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>暴露端口(–expose)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d --name mysql -e MYSQL_RANDOM_ROOT_PASSWORD=yes --expose 13306 --expose 23306 mysql:5.7</span><br><span class="line"></span><br><span class="line">#查看</span><br><span class="line">$ sudo docker ps </span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                                       NAMES</span><br><span class="line">3c4e645f21d7        mysql:5.7           &quot;docker-entrypoint.s…&quot;   4 seconds ago       Up 3 seconds        3306/tcp, 13306/tcp, 23306/tcp, 33060/tcp   mysql</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建网络(docker network)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#查看默认网络</span><br><span class="line">$ sudo docker inspect mysql</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">## ......</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">## ......</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;bridge&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: null,</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;bc14eb1da66b67c7d155d6c78cb5389d4ffa6c719c8be3280628b7b54617441b&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;1e201db6858341d326be4510971b2f81f0f85ebd09b9b168e1df61bab18a6f22&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.17.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.17.0.2&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">## ......</span><br><span class="line">        &#125;</span><br><span class="line">## ......</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">#创建网络</span><br><span class="line">$ sudo docker network create -d bridge individual //-d 指定驱动类型，值:bridge、host、overlay、maclan、none</span><br><span class="line"></span><br><span class="line">#查看已存在网络</span><br><span class="line">$ sudo docker network ls</span><br><span class="line"></span><br><span class="line">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class="line">bc14eb1da66b        bridge              bridge              local</span><br><span class="line">35c3ef1cc27d        individual          bridge              local</span><br></pre></td></tr></table></figure>
</li>
<li><p>加入网络(–network)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d --name mysql -e MYSQL_RANDOM_ROOT_PASSWORD=yes --network individual mysql:5.7</span><br><span class="line"></span><br><span class="line">#查看</span><br><span class="line">$ sudo docker inspect mysql</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">## ......</span><br><span class="line">        &quot;NetworkSettings&quot;: &#123;</span><br><span class="line">## ......</span><br><span class="line">            &quot;Networks&quot;: &#123;</span><br><span class="line">                &quot;individual&quot;: &#123;</span><br><span class="line">                    &quot;IPAMConfig&quot;: null,</span><br><span class="line">                    &quot;Links&quot;: null,</span><br><span class="line">                    &quot;Aliases&quot;: [</span><br><span class="line">                        &quot;2ad678e6d110&quot;</span><br><span class="line">                    ],</span><br><span class="line">                    &quot;NetworkID&quot;: &quot;35c3ef1cc27d24e15a2b22bdd606dc28e58f0593ead6a57da34a8ed989b1b15d&quot;,</span><br><span class="line">                    &quot;EndpointID&quot;: &quot;41a2345b913a45c3c5aae258776fcd1be03b812403e249f96b161e50d66595ab&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;172.18.0.1&quot;,</span><br><span class="line">                    &quot;IPAddress&quot;: &quot;172.18.0.2&quot;,</span><br><span class="line">                    &quot;IPPrefixLen&quot;: 16,</span><br><span class="line">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br><span class="line">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br><span class="line">                    &quot;MacAddress&quot;: &quot;02:42:ac:12:00:02&quot;,</span><br><span class="line">                    &quot;DriverOpts&quot;: null</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">## ......</span><br><span class="line">        &#125;</span><br><span class="line">## ......</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><strong>注意 :</strong> webapp必须与mysql处于同一网络才能正常了解，否在会启动报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#修改webapp网络</span><br><span class="line">$ sudo docker run -d --name webapp --link mysql --network individual webapp:latest</span><br></pre></td></tr></table></figure>

<ul>
<li>端口映射(将容器端口与操作系统端口进行映射)(-p)<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#格式 -p &lt;ip&gt;:&lt;host-port&gt;:&lt;container-port&gt;</span><br><span class="line"># ip:宿主操作系统的监听ip,默认为 0.0.0.0，也就是监听所有网卡</span><br><span class="line"># host-port:宿主操作系统端口</span><br><span class="line"># container-port:容器端口</span><br><span class="line">$ sudo docker run -d --name nginx -p 80:80 -p 443:443 nginx</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="挂载文件系统"><a href="#挂载文件系统" class="headerlink" title="挂载文件系统"></a>挂载文件系统</h3><blockquote>
<p>三种挂载方式 : Bind Mount、Volume 和 Tmpfs Mount</p>
</blockquote>
<p><strong>Bind Mount</strong> 能够直接将宿主操作系统中的目录和文件挂载到容器内的文件系统中，通过指定容器外的路径和容器内的路径，就可以形成挂载映射关系，在容器内外对文件的读写，都是相互可见的。</p>
<p><strong>Volume</strong> 也是从宿主操作系统中挂载目录到容器内，只不过这个挂载的目录由 Docker 进行管理，我们只需要指定容器内的目录，不需要关心具体挂载到了宿主操作系统中的哪里。</p>
<p><strong>Tmpfs Mount</strong> 支持挂载系统内存中的一部分到容器的文件系统里，不过由于内存和容器的特征，它的存储并不是持久的，其中的内容会随着容器的停止而消失。</p>
<ul>
<li>Bind Mount</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># -v &lt;host-path&gt;:&lt;container-path&gt;</span><br><span class="line"># host-path:操作系统目录绝对路径</span><br><span class="line"># container-path:容器目录绝对路径</span><br><span class="line">$ sudo docker run -d --name nginx -v /var/www/html:/usr/share/nginx/html:ro nginx //ro 容器内只读</span><br><span class="line"></span><br><span class="line"># 查看</span><br><span class="line">$ sudo docker inspect nginx</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">## ......</span><br><span class="line">        &quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;bind&quot;,</span><br><span class="line">                &quot;Source&quot;: &quot;/webapp/html&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/usr/share/nginx/html&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;rprivate&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">## ......</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>Tmpfs Mount</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># --tmpfs</span><br><span class="line">$ sudo docker run -d --name webapp --tmpfs /webapp/cache webapp:latest</span><br><span class="line"></span><br><span class="line">#查看</span><br><span class="line">$ sudo docker inspect webapp</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">## ......</span><br><span class="line">         &quot;Tmpfs&quot;: &#123;</span><br><span class="line">            &quot;/webapp/cache&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">## ......</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ul>
<li>Volume</li>
</ul>
<blockquote>
<p>数据卷的本质其实依然是宿主操作系统上的一个目录，只不过这个目录存放在 Docker 内部，我们不需要知道数据具体存储在了宿主操作系统的何处，只需要给定容器中的哪个目录会被挂载即可。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -d --name webapp -v /webapp/storage webapp:latest</span><br><span class="line">#查看</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">## ......</span><br><span class="line">        &quot;Mounts&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;Type&quot;: &quot;volume&quot;,</span><br><span class="line">                &quot;Name&quot;: &quot;2bbd2719b81fbe030e6f446243386d763ef25879ec82bb60c9be7ef7f3a25336&quot;, //数据卷ID</span><br><span class="line">                &quot;Source&quot;: &quot;/var/lib/docker/volumes/2bbd2719b81fbe030e6f446243386d763ef25879ec82bb60c9be7ef7f3a25336/_data&quot;,</span><br><span class="line">                &quot;Destination&quot;: &quot;/webapp/storage&quot;,</span><br><span class="line">                &quot;Driver&quot;: &quot;local&quot;,</span><br><span class="line">                &quot;Mode&quot;: &quot;&quot;,</span><br><span class="line">                &quot;RW&quot;: true,</span><br><span class="line">                &quot;Propagation&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">## ......</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"># 命名数据卷 -v &lt;name&gt;:&lt;container-path&gt;</span><br><span class="line">$ sudo docker run -d --name webapp -v appdata:/webapp/storage webapp:latest</span><br></pre></td></tr></table></figure>

<p><strong>如果引入数据卷不存在，则会自动创建</strong></p>
<ul>
<li>命令方式创建Volume</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"># 创建</span><br><span class="line">$ sudo docker volume create appdata</span><br><span class="line"></span><br><span class="line"># 查看</span><br><span class="line">$ sudo docker volume ls</span><br><span class="line">DRIVER              VOLUME NAME</span><br><span class="line">local               html</span><br><span class="line">local               appdata</span><br><span class="line"></span><br><span class="line"># 删除(如果数据卷被容器引用，则删除失败)</span><br><span class="line">$ sudo docker volume rm appdata</span><br><span class="line"></span><br><span class="line"># 删除容器同时，删除关联数据卷</span><br><span class="line">$ sudo docker rm -v webapp</span><br><span class="line"></span><br><span class="line"># 删除没有被容器引用的数据卷</span><br><span class="line">$ sudo docker volume prune -f</span><br><span class="line">Deleted Volumes:</span><br><span class="line">af6459286b5ce42bb5f205d0d323ac11ce8b8d9df4c65909ddc2feea7c3d1d53</span><br><span class="line">0783665df434533f6b53afe3d9decfa791929570913c7aff10f302c17ed1a389</span><br><span class="line">65b822e27d0be93d149304afb1515f8111344da9ea18adc3b3a34bddd2b243c7</span><br><span class="line">## ......</span><br></pre></td></tr></table></figure>

<ul>
<li>数据卷容器</li>
</ul>
<blockquote>
<p>通过创建数据卷容器，使其他容器持有其引用，方便数据备份、迁移。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 随便找一个镜像，-v后的挂载路径将被所持有引用的容器使用</span><br><span class="line">$ sudo docker create --name appdata -v /webapp/storage ubuntu</span><br><span class="line"></span><br><span class="line"># 引用此数据卷容器(--volumes-from)</span><br><span class="line">$ sudo docker run -d --name webapp --volumes-from appdata webapp:latest</span><br></pre></td></tr></table></figure>

<ul>
<li>备份和迁移数据卷</li>
</ul>
<p><strong>备份</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 将数据卷容器备份至操作系统文件系统的/backup下，并打包</span><br><span class="line"># --rm 容器停止后自动删除</span><br><span class="line"># 如果镜像之后有额外的命令，将替换镜像定义的主程序启动命令，而执行此额外命令</span><br><span class="line">$ sudo docker run --rm --volumes-from appdata -v /backup:/backup ubuntu tar cvf /backup/backup.tar /webapp/storage</span><br></pre></td></tr></table></figure>

<blockquote>
<p>解释 : 随便用一个镜像启动，使用–volumes-from引用数据卷容器，使用-v挂载/backup系统目录到容器内/backup目录，执行tar打包命令，将数据卷容器内定义的挂载路径目录，打包至-v挂载的/backup目录下。命令结束后，容器便停止运行，–rm将删除此容器。在系统目录/backup下，会发现backup.tar文件。</p>
</blockquote>
<p><strong>恢复备份</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 与备份同理。</span><br><span class="line"># --strip 清除标识符号等，属于Linux命令，请自行查阅</span><br><span class="line">$ docker run --rm --volumes-from appdata -v /backup:/backup ubuntu tar xvf /backup/backup.tar -C /webapp/storage --strip</span><br></pre></td></tr></table></figure>

<h3 id="保存和共享镜像"><a href="#保存和共享镜像" class="headerlink" title="保存和共享镜像"></a>保存和共享镜像</h3><ul>
<li>提交容器修改为镜像</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 将容器修改保存为镜像，并重新命名</span><br><span class="line">$ sudo docker commit -m &quot;Upgrade&quot; webapp webapp:1.0 //-m 添加一些提交信息</span><br><span class="line"></span><br><span class="line"># 重命名镜像</span><br><span class="line">$ sudo docker tag webapp:1.0 webapp:latest</span><br></pre></td></tr></table></figure>

<blockquote>
<p>重命名镜像后，命名之前的镜像也会存在，但两个镜像都指向同一个镜像，而不会产生两份</p>
</blockquote>
<ul>
<li>镜像迁移 -&gt; 镜像打包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 导出镜像</span><br><span class="line">$ sudo docker save -o ./webapp-1.0.tar webapp:1.0 //导出为压缩文件</span><br><span class="line"></span><br><span class="line"># 批量导出</span><br><span class="line">$ sudo docker save -o ./images.tar webapp:1.0 nginx:1.12 mysql:5.7</span><br><span class="line"></span><br><span class="line"># 导入镜像</span><br><span class="line">$ sudo docker load -i webapp-1.0.tar // 导入的镜像会延用原有的镜像名称</span><br></pre></td></tr></table></figure>

<blockquote>
<p>批量导入 : 装有多个镜像的包可以直接被 <code>docker load</code>  识别和读取，我们将这个包导入后，所有其中装载的镜像都会被导入到 Docker 之中。</p>
</blockquote>
<ul>
<li>镜像迁移 -&gt; 容器打包</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 导出镜像</span><br><span class="line"># 可以看做是docker commit 与 docker save 的结合体。</span><br><span class="line">$ sudo docker export -o ./webapp.tar webapp</span><br><span class="line"></span><br><span class="line"># 导入镜像(可以同时给镜像命名)</span><br><span class="line">$ sudo docker import ./webapp.tar webapp:1.0</span><br></pre></td></tr></table></figure>

<h3 id="Laravel项目开发环境部署测试"><a href="#Laravel项目开发环境部署测试" class="headerlink" title="Laravel项目开发环境部署测试"></a>Laravel项目开发环境部署测试</h3><ul>
<li>服务器环境为腾讯云CentOS7，且未安装任何软件</li>
<li>为了方便测试，权限为root</li>
<li>运行镜像: nginx、php、redis、mysql</li>
<li>使用了docker-compose容器编排</li>
<li>写了几个方便部署的脚本</li>
</ul>
<p>我的测试过程是这样的</p>
<ol>
<li><p>在服务器编写需要用到的Dockerfile镜像文件和docker-compose.yml文件，将需要运行的服务如nginx、php-fpm等配置文件配置好(就是正常配置)，写几个简化部署的脚本(其中一个是start.sh，用于新服务器安装)，然后把所有配置打成tar.gz包，下载下来。</p>
</li>
<li><p>接下来，进入腾讯云控制台，重做系统。</p>
</li>
<li><p>上传之前下载的tar.gz包，解压，运行start.sh。</p>
</li>
<li><p>喝咖啡。。。</p>
</li>
<li><p>改一下laravel的.env文件(因为一般不放在代码仓库中)</p>
</li>
<li><p>浏览器访问，结束。</p>
</li>
</ol>
<h4 id="详细过程"><a href="#详细过程" class="headerlink" title="详细过程"></a>详细过程</h4><ul>
<li>配置文件目录</li>
</ul>
<blockquote>
<p>我将所有配置文件及容器挂载目录等，放到了/mydata下，这是我的服务器挂载的一块数据磁盘</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#主目录结构</span><br><span class="line">./mydata</span><br><span class="line">|-- docker-conf //docker所有的配置文件及脚本</span><br><span class="line">|-- logs        //容器运行产生的日志，比如nginx</span><br><span class="line">`-- project     //项目代码目录，用于脚本自动从svn仓库拉取代码</span><br></pre></td></tr></table></figure>

<p>在配置完成之后，只需要对以上三个目录打包，迁移到其他服务器，解压，运行脚本即可。</p>
<ul>
<li>docker-conf目录结构</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">docker-conf</span><br><span class="line">|-- bin                      //所有脚本命令</span><br><span class="line">|   |-- composer_up.sh       //用于composer包管理器update项目依赖</span><br><span class="line">|   |-- compose.sh           //简化docker-compose命令</span><br><span class="line">|   |-- new.sh               //多项目时，运行此脚本自动拉取代码</span><br><span class="line">|   |-- sql.sh               //mysql容器database.sql导入及导出</span><br><span class="line">|   `-- start.sh             //如果是新服务器，一键部署</span><br><span class="line">|-- compose                  //容器编排目录</span><br><span class="line">|   |-- docker-compose.yml   //容器编排配置文件</span><br><span class="line">|   `-- phpfpm        </span><br><span class="line">|       `-- Dockerfile       //php-fpm自定义镜像(包括安装扩展及composer包管理器安装)</span><br><span class="line">|-- mysql</span><br><span class="line">|   |-- data                 //mysql产生数据挂载目录</span><br><span class="line">|   |   | ... //此处省略</span><br><span class="line">|   |</span><br><span class="line">|   |-- my.cnf               //mysql配置文件挂载目录</span><br><span class="line">|   `-- sql</span><br><span class="line">|       `-- sanyuan</span><br><span class="line">|           `-- sanyuan.sql  //项目数据库脚本文件</span><br><span class="line">|-- nginx</span><br><span class="line">|   |-- conf.d               //nginx配置文件挂载目录</span><br><span class="line">|   |   `-- sanyuan.conf  </span><br><span class="line">|   `-- nginx.conf           //nginx主配置文件挂载目录</span><br><span class="line">|-- phpfpm</span><br><span class="line">|   |-- php-fpm.conf         //phpfpm配置文件挂载目录</span><br><span class="line">|   |-- php-fpm.d</span><br><span class="line">|   |   |-- docker.conf      //此文件在下面解释</span><br><span class="line">|   |   |-- www.conf</span><br><span class="line">|   |   `-- zz-docker.conf   //此文件在下面解释</span><br><span class="line">|   `-- php.ini</span><br><span class="line">`-- redis</span><br><span class="line">    |-- data                 //redis持久化数据挂载目录</span><br><span class="line">    |   `-- dump.rdb</span><br><span class="line">    `-- redis.conf           //redis配置文件</span><br></pre></td></tr></table></figure>

<p>以上所有服务的配置文件，都可以用一个运行的容器复制而来</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 比如nginx</span><br><span class="line">$ docker run --name tmp-nginx-container -d nginx</span><br><span class="line">$ docker cp tmp-nginx-container:/etc/nginx/nginx.conf /host/path/nginx.conf</span><br><span class="line">$ docker rm -f tmp-nginx-container</span><br></pre></td></tr></table></figure>

<p>运行一个临时容器，然后将配置文件cp到系统目录即可。</p>
<p>这里有个坑，就是php-fpm容器会产生两个额外的文件，<code>docker.conf</code>  与 <code>zz-docker.conf</code> ，这两个文件我也不知道干什么的，但是如果它们不出现在php-fpm.d挂载目录中，运行容器会exit(0)无错误退出。</p>
<p>关于服务器的配置，都是正常配置，下面主要说和docker相关的配置及脚本</p>
<p><strong>Dockerfile – php-fpm镜像文件</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"># 以FROM开头，从已经存在的镜像开始扩展，这里选择具有fpm功能的php镜像</span><br><span class="line">FROM php:7.3-fpm</span><br><span class="line"></span><br><span class="line"># 添加nginx用户与组，并制定其id</span><br><span class="line"># 这里有个问题就是，对挂载的系统目录及文件，docker内部用户与系统用户具有相同的uid及权限。</span><br><span class="line">#这样，你在docker内和在系统目录中看到的权限名称虽然不一样，但是他们id确实相同的。</span><br><span class="line"># 这里的101，是因为容器内的nginx id是101，所以为了让名称统一，在系统目录中也如此设置。</span><br><span class="line">#但肯定有更好的方式，目前还不会呢。。。</span><br><span class="line">RUN groupadd -g 101 -r nginx &amp;&amp; useradd -u 101 -r -g nginx nginx</span><br><span class="line"></span><br><span class="line"># 生成.ini文件</span><br><span class="line">RUN mv &quot;$PHP_INI_DIR/php.ini-production&quot; &quot;$PHP_INI_DIR/php.ini&quot;</span><br><span class="line"></span><br><span class="line"># 安装容器内部扩展，包括vim、ps等命令</span><br><span class="line">RUN apt-get update \</span><br><span class="line"> &amp;&amp; apt-get install -y --no-install-recommends apt-utils vim net-tools git zip unzip procps</span><br><span class="line"></span><br><span class="line">#安装msyql扩展，具体用法可以看官方镜像介绍</span><br><span class="line">RUN docker-php-ext-install pdo_mysql</span><br><span class="line"></span><br><span class="line">#以下是安装composer包管理工具</span><br><span class="line">RUN php -r &quot;copy(&apos;https://getcomposer.org/installer&apos;, &apos;composer-setup.php&apos;);&quot;</span><br><span class="line"></span><br><span class="line">RUN php -r &quot;if (hash_file(&apos;sha384&apos;, &apos;composer-setup.php&apos;) === &apos;48e3236262b34d30969dca3c37281b3b4bbe3221bda826ac6a9a62d6444cdb0dcd0615698a5cbe587c3f0fe57a54d8f5&apos;) &#123; echo &apos;Installer verified&apos;;  &#125; else &#123; echo &apos;Installer corrupt&apos;; unlink(&apos;composer-setup.php&apos;);  &#125; echo PHP_EOL;&quot;</span><br><span class="line"></span><br><span class="line">RUN php composer-setup.php</span><br><span class="line"></span><br><span class="line">RUN php -r &quot;unlink(&apos;composer-setup.php&apos;);&quot;</span><br><span class="line"></span><br><span class="line">RUN mv composer.phar /usr/local/bin/composer</span><br><span class="line"></span><br><span class="line">#给composer配置国内镜像</span><br><span class="line">RUN composer config -g repo.packagist composer https://packagist.laravel-china.org</span><br><span class="line"></span><br><span class="line">#暴露端口</span><br><span class="line">EXPOSE 9000</span><br><span class="line"></span><br><span class="line">#执行启动命令</span><br><span class="line">ENTRYPOINT [&quot;php-fpm&quot;]</span><br></pre></td></tr></table></figure>

<p><strong>docker-compose.yml编排配置</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">#yml版本</span><br><span class="line">version: &quot;3&quot;</span><br><span class="line"></span><br><span class="line">#配置网络</span><br><span class="line">networks:</span><br><span class="line">  frontend:</span><br><span class="line">    driver: bridge #网桥模式</span><br><span class="line">  backend:</span><br><span class="line">    driver: bridge</span><br><span class="line"></span><br><span class="line">#所有的容器服务，都在services下</span><br><span class="line">services:</span><br><span class="line"></span><br><span class="line">  nginx:</span><br><span class="line">    image: nginx  #用来自动构建的镜像名称</span><br><span class="line">    container_name: nginx  #容器启动后的容器名称</span><br><span class="line">    restart: always   #宕掉后自动重启</span><br><span class="line">    privileged: true  #运行权限(目前还不知道怎么用)</span><br><span class="line">    networks:</span><br><span class="line">    - frontend</span><br><span class="line">    volumes:          #需要挂载到的系统目录</span><br><span class="line">    - ../nginx/nginx.conf:/etc/nginx/nginx.conf:ro</span><br><span class="line">    - ../nginx/conf.d:/etc/nginx/conf.d:ro</span><br><span class="line">    - /mydata/project:/var/www/html</span><br><span class="line">    - /mydata/logs/nginx:/var/log/nginx</span><br><span class="line">    links:</span><br><span class="line">    - phpfpm         #连接到php-fpm所在的网段</span><br><span class="line">    depends_on:</span><br><span class="line">    - phpfpm         #需要等php-fpm启动后，在启动nginx(但不是强依赖，需要强依赖请看docker文档)</span><br><span class="line">    ports:     #映射到系统的端口</span><br><span class="line">    - &quot;80:80&quot;</span><br><span class="line"></span><br><span class="line">  phpfpm:</span><br><span class="line">    build: ./phpfpm    #刚才自己扩展的phpfpm Dockerfile镜像目录</span><br><span class="line">    container_name: php-fpm</span><br><span class="line">    restart: always</span><br><span class="line">    networks:</span><br><span class="line">    - frontend</span><br><span class="line">    - backend</span><br><span class="line">    volumes:</span><br><span class="line">    - ../phpfpm/php-fpm.d:/usr/local/etc/php-fpm.d:ro</span><br><span class="line">    - ../phpfpm/php.ini:/usr/local/etc/php/php.ini:ro</span><br><span class="line">    - ../phpfpm/php-fpm.conf:/usr/local/etc/php-fpm.conf:ro</span><br><span class="line">    - /mydata/project:/var/www/html  #此处额外说明，必须要把挂载到nginx的项目目录，也挂载到php-fpm中。</span><br><span class="line">    #可以让php-fpm找到要执行的php脚本的位置</span><br><span class="line">    expose:</span><br><span class="line">    - &quot;9000&quot;</span><br><span class="line">    depends_on:</span><br><span class="line">    - mysql</span><br><span class="line">    - redis</span><br><span class="line"></span><br><span class="line">  mysql:                 #mysql相关参数及用法，可以参考镜像文档</span><br><span class="line">    image: mysql</span><br><span class="line">    container_name: mysql</span><br><span class="line">    restart: always</span><br><span class="line">    command: --default-authentication-plugin=mysql_native_password</span><br><span class="line">    networks:</span><br><span class="line">    - backend</span><br><span class="line">    volumes:</span><br><span class="line">    - ../mysql/my.cnf:/etc/mysql/my.cnf:ro</span><br><span class="line">    - ../mysql/data:/var/lib/mysql</span><br><span class="line">    environment:</span><br><span class="line">      MYSQL_ROOT_PASSWORD: your-root-password</span><br><span class="line">    expose:</span><br><span class="line">    - &quot;3306&quot;</span><br><span class="line"></span><br><span class="line">  redis:</span><br><span class="line">    image: redis</span><br><span class="line">    container_name: redis</span><br><span class="line">    restart: always</span><br><span class="line">    networks:</span><br><span class="line">    - backend</span><br><span class="line">    volumes:</span><br><span class="line">    - ../redis/redis.conf:/usr/local/etc/redis/redis.conf</span><br><span class="line">    - ../redis/data:/data</span><br><span class="line">    command: [&quot;redis-server&quot;, &quot;/usr/local/etc/redis/redis.conf&quot;]</span><br><span class="line">    expose:</span><br><span class="line">    - &quot;6379&quot;</span><br></pre></td></tr></table></figure>

<p>目前为止，每个服务的配置文件、自定义镜像、与容器编排配置文件已经写好了。只需执行命令，即可启动所有服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#docker-compose配置下面说</span><br><span class="line">docker-compose -f docker-compose.yml up -d //-f 指定编排配置文件位置(如果在配置文件所在目录，docker会自动找yml配置文件)，-d在后台</span><br></pre></td></tr></table></figure>

<p>启动以上命令，docker会根据docker-compose编排配置，依据自定义顺序(depends_on),pull镜像，执行镜像脚本，最后启动容器。</p>
<p><strong>相关脚本</strong></p>
<p>为了方便，我写了几个脚本(一边学一遍写。。。)</p>
<p>start.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">#在当前系统添加nginx用户</span><br><span class="line">groupadd -g 101 -r nginx &amp;&amp; useradd -u 101 -r -g nginx nginx</span><br><span class="line"></span><br><span class="line">#安装svn（用git都一样）</span><br><span class="line">yum -y install svn</span><br><span class="line"></span><br><span class="line">#安装docker</span><br><span class="line">yum install yum-utils device-mapper-persistent-data lvm2</span><br><span class="line">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span><br><span class="line">yum install docker-ce</span><br><span class="line">systemctl enable docker</span><br><span class="line">systemctl start docker</span><br><span class="line">systemctl start docker</span><br><span class="line">docker version</span><br><span class="line">touch /etc/docker/daemon.json</span><br><span class="line">echo &apos;&apos; &gt; /etc/docker/daemon.json</span><br><span class="line">echo &apos;&#123;&quot;registry-mirrors&quot;: [&quot;https://registry.docker-cn.com&quot;]&#125;&apos; &gt; /etc/docker/daemon.json</span><br><span class="line">systemctl restart docker</span><br><span class="line"></span><br><span class="line">#安装docker-compose</span><br><span class="line">curl -L &quot;https://github.com/docker/compose/releases/download/1.22.0/docker-compose-$(uname -s)-$(uname -m)&quot; -o /usr/local/bin/docker-compose</span><br><span class="line">chmod +x /usr/local/bin/docker-compose</span><br><span class="line">docker-compose version</span><br><span class="line"></span><br><span class="line">#拉取项目代码</span><br><span class="line">./new.sh</span><br><span class="line"></span><br><span class="line">#启动所有容器</span><br><span class="line">./compose.sh up -d</span><br><span class="line"></span><br><span class="line">#更新代码依赖</span><br><span class="line">./composer_up.sh</span><br></pre></td></tr></table></figure>

<p>new.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">#svn仓库host</span><br><span class="line">svn_host=&quot;xxx.com&quot;</span><br><span class="line"></span><br><span class="line">#根据不同项目，拉取对应代码</span><br><span class="line">read -p &quot;input your project snv name : &quot; i</span><br><span class="line"></span><br><span class="line">svn co svn://$svn_host/$i ../../project/php/$i</span><br><span class="line"></span><br><span class="line">cd ../../project/php/$i &amp;&amp; cp .env.example .env</span><br><span class="line"></span><br><span class="line">#创建其他目录</span><br><span class="line">mkdir -p bootstrap/cache</span><br><span class="line">mkdir -p storage/app/public</span><br><span class="line">mkdir -p storage/framework/cache</span><br><span class="line">mkdir -p storage/framework/sessions</span><br><span class="line">mkdir -p storage/framework/testing</span><br><span class="line">mkdir -p storage/framework/views</span><br><span class="line">mkdir -p storage/logs</span><br><span class="line"></span><br><span class="line">#修改执行权限</span><br><span class="line">chown -R nginx:nginx ../$i</span><br><span class="line"># 这里的33，在nginx与php-fpm容器中是www-data</span><br><span class="line">chown -R 33:33 ./storage</span><br></pre></td></tr></table></figure>

<p>compose.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">docker-compose -f ../compose/docker-compose.yml &quot;$@&quot;</span><br></pre></td></tr></table></figure>

<p>只需运行./compose.sh up -d即可</p>
<p>docker-composer常用指令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker-compose -f 配置文件 up -d</span><br><span class="line">docker-compose -f 配置文件 up -d --build //build参数，当自定义镜像发生修改时，使用此参数，重新构建</span><br><span class="line">docker-compose -f 配置文件 down</span><br><span class="line">docker-compose restart 服务名称</span><br><span class="line">docker-compose stop 服务名称</span><br><span class="line">docker-compose start 服务名称</span><br><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure>

<p>composer_up.sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">read -p &quot;input your project name : &quot; i</span><br><span class="line"></span><br><span class="line">docker exec php-fpm sh -c &apos;cd /var/www/html/php/&apos;$i&apos; &amp;&amp; composer update --no-dev&apos;</span><br></pre></td></tr></table></figure>

<p>sql.sh</p>
<blockquote>
<p>对于数据库，如果迁移时挂载data目录下没有数据，还需要手动创建用户，并建database，然后使用此脚本导入相应sql文件即可。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line"></span><br><span class="line">read -p &quot;Import or export database ? [i/o]&quot; q</span><br><span class="line"></span><br><span class="line">if [ &quot;$q&quot; = &quot;i&quot; ]||[ &quot;$q&quot; = &quot;I&quot; ]</span><br><span class="line">then</span><br><span class="line">    read -p &quot;input your project name : &quot; i</span><br><span class="line">    read -p &quot;input your mysql password : &quot; p</span><br><span class="line">    #mysql导入导出命令，可见mysql镜像文档</span><br><span class="line">    docker exec -i mysql mysql -uroot -p&quot;$p&quot; $i &lt;  ../mysql/sql/$i/$i.sql</span><br><span class="line">    echo database import done</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">if [ &quot;$q&quot; = &quot;o&quot;  ]||[ &quot;$q&quot; = &quot;O&quot; ]</span><br><span class="line">then</span><br><span class="line">    read -p &quot;input your project name : &quot; i</span><br><span class="line">    read -p &quot;input your mysql password : &quot; p</span><br><span class="line">    docker exec -i mysql mysqldump -uroot -p&quot;$p&quot; $i &gt;  ../mysql/sql/$i/$i.sql</span><br><span class="line">    echo database export done</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">echo invalid input parameter</span><br></pre></td></tr></table></figure>

<p>以上的脚本，包括:自动安装svn、docker、docker-compose，自动拉取代码、创建目录并修改权限，下载镜像并启动所有容器，更新laravel项目代码所有依赖。</p>
<p>最后，配合一下laravel项目的.env配置文件即可。</p>
<p>.env</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">DB_CONNECTION=mysql </span><br><span class="line">DB_HOST=mysql    #直接写服务名称即可</span><br><span class="line">DB_PORT=3306</span><br><span class="line">DB_DATABASE=</span><br><span class="line">DB_USERNAME=</span><br><span class="line">DB_PASSWORD=</span><br><span class="line"></span><br><span class="line">BROADCAST_DRIVER=log</span><br><span class="line">CACHE_DRIVER=redis</span><br><span class="line">QUEUE_CONNECTION=redis</span><br><span class="line">SESSION_DRIVER=redis</span><br><span class="line">SESSION_LIFETIME=120</span><br><span class="line"></span><br><span class="line">REDIS_HOST=redis    #直接写服务名称即可</span><br><span class="line">REDIS_PASSWORD=</span><br><span class="line">REDIS_PORT=6379</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p><code>docker ps</code>看到所有容器运行后，打开浏览器访问即可。</p>
<p>将所有目录打包，迁移，解压，运行，喝咖啡，即可。</p>
<p>tar打包命令可以参考：<a href="https://blog.51cto.com/xiaocao13140/2121170" target="_blank" rel="noopener">https://blog.51cto.com/xiaocao13140/2121170</a></p>
<p>cvzpf -&gt; tar.gz</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>本文是看了docker掘进小册后的学习笔记，最后的部署测试，也是根据我的想法做的，肯定会有各种问题，在此仅对本周学习做一个总结与记录。</p>
<blockquote>
<p>如果是php项目的话，有个强大的docker库:<br><a href="https://github.com/laradock/laradock" target="_blank" rel="noopener">https://github.com/laradock/laradock</a></p>
</blockquote>
<h3 id="一些问题"><a href="#一些问题" class="headerlink" title="一些问题"></a>一些问题</h3><p>composer的 hash 值会定期更改，当报错composer-setup.php找不到或无效的时候，更新为官网最新的 hash 值</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Docker/" rel="tag"># Docker</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/02/29/OM/基于docker搭建redis一主两从三哨兵/" rel="next" title="基于docker搭建redis一主两从三哨兵">
                <i class="fa fa-chevron-left"></i> 基于docker搭建redis一主两从三哨兵
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/03/23/english/Level4-Unit1/" rel="prev" title="Level4.Unit1">
                Level4.Unit1 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">R.D</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          
<br>

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装"><span class="nav-number">1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置镜像"><span class="nav-number">2.</span> <span class="nav-text">配置镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#镜像仓库"><span class="nav-number">3.</span> <span class="nav-text">镜像仓库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#管理命令"><span class="nav-number">4.</span> <span class="nav-text">管理命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#exec-：连接容器内bash"><span class="nav-number">5.</span> <span class="nav-text">exec ：连接容器内bash</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置网络"><span class="nav-number">6.</span> <span class="nav-text">配置网络</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#挂载文件系统"><span class="nav-number">7.</span> <span class="nav-text">挂载文件系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#保存和共享镜像"><span class="nav-number">8.</span> <span class="nav-text">保存和共享镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Laravel项目开发环境部署测试"><span class="nav-number">9.</span> <span class="nav-text">Laravel项目开发环境部署测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#详细过程"><span class="nav-number">9.1.</span> <span class="nav-text">详细过程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number">10.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一些问题"><span class="nav-number">11.</span> <span class="nav-text">一些问题</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">R.D</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
